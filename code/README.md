# Lidar Corner Detection in C

## Description

This project implements a Lidar-based corner detection algorithm in C. It reads Lidar scan data from a CSV file (`src/LidarData.csv`), processes the data to identify 90-degree corners, and outputs two CSV files:
1.  `lidarDataCartesian.csv`: Contains the Cartesian coordinates (x, y) of all Lidar points from the input scan that were processed after an initial radial filter.
2.  `outputCorners.csv`: Contains the Cartesian coordinates (x, y) of the detected corners.

The project also includes a Python script (`plotting.py`) to visualize these output CSV files.

## Code Structure

*   `CMakeLists.txt`: The CMake build script for compiling the C project.
*   `src/`: Directory containing the C source code and sample Lidar data.
    *   `main.c`: The main program file. It handles reading data from `LidarData.csv`, orchestrates the corner detection process by calling functions from `corner_detect.c`, and writes the output CSV files.
    *   `corner_detect.h` / `corner_detect.c`: Implements the core corner detection logic. This includes:
        *   Polar to Cartesian coordinate conversion.
        *   Applying a radial mask to filter points based on distance.
        *   Calculating the angle between vectors formed by Lidar points.
        *   Detecting potential corners based on angles and distances.
        *   Filtering and reducing detected corner candidates.
    *   `csv_reader.h` / `csv_reader.c`: A utility for reading data from CSV files.
    *   `LidarData.csv`: Sample input Lidar data file. Each row represents a distance measurement.
*   `plotting.py`: A Python script that uses `matplotlib` to read `lidarDataCartesian.csv` and `outputCorners.csv` and generate a plot showing all Lidar points in blue and detected corners in red.
*   `lidarDataCartesian.csv` (output): Generated by `cornerDetection`, contains processed Lidar points in Cartesian coordinates (in millimeters).
*   `outputCorners.csv` (output): Generated by `cornerDetection`, contains detected corners in Cartesian coordinates (in millimeters).

## Build Instructions

### Prerequisites

*   CMake (version 3.10 or higher)
*   A C compiler (e.g., GCC, Clang)

### Steps

1.  **Navigate to the `code` directory:**
    Open your terminal and change to the `code` directory where the `CMakeLists.txt` file is located.
    ```bash
    cd path/to/your/project/code
    ```

2.  **Create a build directory:**
    It's good practice to build CMake projects out-of-source.
    ```bash
    mkdir build
    cd build
    ```

3.  **Run CMake to configure the project:**
    This command looks for the `CMakeLists.txt` in the parent directory (`..`).
    ```bash
    cmake ..
    ```

4.  **Compile the project:**
    This command runs the actual compilation process using the Makefiles generated by CMake.
    ```bash
    make
    ```
    After this step, you should find the executable `cornerDetection` inside the `build` directory.

## Running the Program and Plotting Results

After successfully building the project using `make` in the `build` directory:

1.  **Run the C executable and generate plots automatically:**
    While still in the `build` directory, use the following command:
    ```bash
    make run_and_plot
    ```
    This command will:
    *   Ensure the `cornerDetection` executable is up-to-date.
    *   Run `cornerDetection`. It reads data from `../src/LidarData.csv` (relative to the `build` directory) and generates `lidarDataCartesian.csv` and `outputCorners.csv` in the `build` directory.
    *   Automatically copy these two CSV files to the `code` directory.
    *   Automatically execute the `plotting.py` script from the `code` directory to visualize the results.

2.  **Prerequisites for Plotting:**
    *   Python 3
    *   Matplotlib (`pip install matplotlib`)

    If `plotting.py` fails to run, ensure you have these installed. The CMake configuration step (`cmake ..`) will also try to find Python 3.
