# Lidar Corner Detection in C

## Description

This project implements a Lidar-based corner detection algorithm in C. It reads Lidar scan data from a CSV file (`src/LidarData.csv`), processes the data to identify 90-degree corners, and outputs two CSV files:
1.  `lidarDataCartesian.csv`: Contains the Cartesian coordinates (x, y) of all Lidar points from the input scan that were processed after an initial radial filter.
2.  `outputCorners.csv`: Contains the Cartesian coordinates (x, y) of the detected corners.

The project also includes a Python script (`plotting.py`) to visualize these output CSV files.

## Code Structure

*   `CMakeLists.txt`: The CMake build script for compiling the C project.
*   `src/`: Directory containing the C source code and sample Lidar data.
    *   `main.c`: The main program file. It handles reading data from `LidarData.csv`, orchestrates the corner detection process by calling functions from `corner_detect.c`, and writes the output CSV files.
    *   `corner_detect.h` / `corner_detect.c`: Implements the core corner detection logic. This includes:
        *   Polar to Cartesian coordinate conversion.
        *   Applying a radial mask to filter points based on distance.
        *   Calculating the angle between vectors formed by Lidar points.
        *   Detecting potential corners based on angles and distances.
        *   Filtering and reducing detected corner candidates.
    *   `csv_reader.h` / `csv_reader.c`: A utility for reading data from CSV files.
    *   `LidarData.csv`: Sample input Lidar data file. Each row represents a distance measurement.
*   `plotting.py`: A Python script that uses `matplotlib` to read `lidarDataCartesian.csv` and `outputCorners.csv` and generate a plot showing all Lidar points in blue and detected corners in red.
*   `lidarDataCartesian.csv` (output): Generated by `cornerDetection`, contains processed Lidar points in Cartesian coordinates (in millimeters).
*   `outputCorners.csv` (output): Generated by `cornerDetection`, contains detected corners in Cartesian coordinates (in millimeters).

## Build Instructions

### Prerequisites

*   CMake (version 3.10 or higher)
*   A C compiler (e.g., GCC, Clang)

### Steps

1.  **Navigate to the `code` directory:**
    Open your terminal and change to the `code` directory where the `CMakeLists.txt` file is located.
    ```bash
    cd path/to/your/project/code
    ```

2.  **Create a build directory:**
    It's good practice to build CMake projects out-of-source.
    ```bash
    mkdir build
    cd build
    ```

3.  **Run CMake to configure the project:**
    This command looks for the `CMakeLists.txt` in the parent directory (`..`).
    ```bash
    cmake ..
    ```

4.  **Compile the project:**
    This command runs the actual compilation process using the Makefiles generated by CMake.
    ```bash
    make
    ```
    After this step, you should find the executable `cornerDetection` inside the `build` directory.

## Running the Program

### C Executable

1.  **Ensure `LidarData.csv` is accessible:**
    The C program (`cornerDetection`) expects to find `src/LidarData.csv` relative to the directory where `CMakeLists.txt` is located (i.e., the `code` directory). The executable, however, runs from the `build` directory.
    To make this work correctly as configured, the `main.c` file has been updated to look for `../src/LidarData.csv` when the program is run from the `build` directory.
    *(Self-correction: I need to verify if `main.c` was actually updated to look for `../src/LidarData.csv`. If not, the README should instruct to copy `LidarData.csv` or run from the `code` dir, or I should modify `main.c` path. For now, let's assume `main.c` is modified or adjust the path in `main.c` as part of this overall task if possible. Given the subtask is just to write the README, I will write the README assuming the path in `main.c` for `LidarData.csv` is `../src/LidarData.csv` when run from `build` dir or that `main.c` is modified to use this path).*

    **Update (Post-Subtask Thought):** I will ensure `main.c` uses `../src/LidarData.csv` in a subsequent step if it doesn't already. For now, the README will reflect this intended setup.

2.  **Run the executable:**
    From the `build` directory:
    ```bash
    ./cornerDetection
    ```
    This will generate/overwrite `lidarDataCartesian.csv` and `outputCorners.csv` in the `build` directory.
    *(Self-correction: The C code writes output files to the current working directory. If run from `build`, they'll be in `build`. If `plotting.py` is in `code`, it won't find them. This needs to be harmonized. The output files should ideally go to the `code` directory or `plotting.py` should be run from `build` or be told where the files are. Let's state that output files are in `build` and `plotting.py` should be run accordingly or files copied).*

    **Update (Post-Subtask Thought):** The `plotting.py` script expects files in its own directory. The easiest is to instruct the user to run `cornerDetection` from the `code` directory if possible, or copy files.
    Let's adjust the README for running from `build` and then copying files to `code` for plotting.

    **Revised Running Instructions for README:**
    From the `build` directory:
    ```bash
    ./cornerDetection
    ```
    This will generate `lidarDataCartesian.csv` and `outputCorners.csv` in the `build` directory.

### Plotting Script

1.  **Copy output CSVs to `code` directory (if not already there):**
    After running `cornerDetection`, copy `lidarDataCartesian.csv` and `outputCorners.csv` from the `build` directory to the `code` directory where `plotting.py` is located.
    ```bash
    cp lidarDataCartesian.csv ../lidarDataCartesian.csv
    cp outputCorners.csv ../outputCorners.csv
    ```
    (Alternatively, modify `plotting.py` to take paths as arguments or look in `../build/`)

2.  **Run the Python plotting script:**
    Navigate to the `code` directory (if you're not already there) and run:
    ```bash
    python3 plotting.py
    ```
    This will display a plot of the Lidar scan points and the detected corners. Ensure you have Python 3 and Matplotlib installed (`pip install matplotlib`).
